# 394.字符串解码

https://leetcode.cn/problems/decode-string/description/?envType=study-plan-v2&envId=top-100-liked

```java
class Solution {
    public String decodeString(String s) {
        Stack<String> stack = new Stack<>();

        for (char c : s.toCharArray()) {
            if (c != ']') {
                stack.push(String.valueOf(c));
            } else {
                // 1. 弹出子串直到遇到 '['
                StringBuilder sb = new StringBuilder();
                while (!stack.isEmpty() && !stack.peek().equals("[")) {
                    sb.insert(0, stack.pop()); // 从前面插入保证顺序
                }
                stack.pop(); // 弹出 '['
                // 2. 弹出数字
                StringBuilder numSb = new StringBuilder();
                while (!stack.isEmpty() && Character.isDigit(stack.peek().charAt(0))) {
                    numSb.insert(0, stack.pop()); // 从前面插入保证顺序
                }
                int repeatCount = numSb.length() > 0 ? Integer.parseInt(numSb.toString()) : 1;
                // 3. 重复子串
                String repeatStr = sb.toString();
                StringBuilder repeated = new StringBuilder();
                for (int i = 0; i < repeatCount; i++) {
                    repeated.append(repeatStr);
                }
                // 4. 入栈
                stack.push(repeated.toString());
            }
        }
        // 合并栈中剩余字符串
        StringBuilder ans = new StringBuilder();
        while (!stack.isEmpty()) {
            ans.insert(0, stack.pop());
        }
        return ans.toString();
    }
}
```

在没有遇到“]”时，直接把所有的入栈，当遇到“]”时，弹出栈内的元素直到碰到"[",再继续弹出重复数字，将其重复处理后作为一个字符串重新压入栈内继续进行处理，最终弹出栈内的所有元素拼接成一个字符串